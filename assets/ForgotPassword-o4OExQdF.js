import{u as C,r as i,j as e}from"./index-t8r2_LHW.js";import{B as c}from"./Button-BwEmg0zX.js";import{H as P}from"./Headline-CwRnmAIK.js";import{v as R}from"./validateEmail-BIDw8Q-C.js";import{P as S}from"./PopUp-CeSf8eW7.js";import{s as T}from"./supabaseClient-DEXQobeG.js";import{L as F}from"./Loader-DKMNs3v0.js";const U=()=>{const u=C(),[r,h]=i.useState({email:"",emailRetyped:""}),[p,g]=i.useState(!1),[f,l]=i.useState(!1),[x,j]=i.useState(e.jsx(e.Fragment,{children:e.jsx("h3",{children:"This feature is currently a WIP"})})),a=document.getElementById("errorMsg"),w=(t,s)=>{if(a){if(t&&s)return;if(a.innerText="Please edit in the following fields: [",!t){a.innerText+="Email,Â ";const n=document.getElementById("loginEmailInput");n==null||n.classList.add("error")}a.innerText+="]"}},m=t=>{h({...r,[t.target.name]:t.target.value}),t.target.classList.remove("error")},d=()=>{const t=document.getElementById("popup");t==null||t.classList.add("fadeOut"),setTimeout(()=>{u("/login")},300)},y=(t,s)=>t===s,E=async t=>{l(!0);const{data:s,error:n}=await T.auth.resetPasswordForEmail(t,{redirectTo:"https://lilithswe.github.io/TheStitchMarkerAssistant/#/forgotPasswordForm/"});n&&a&&(a.innerText=n.message),s&&(console.log("Data from sendNewPasswordRequest:",s),setTimeout(()=>{const o=document.getElementById("loader");o==null||o.classList.add("fadeOut")},650),setTimeout(()=>{l(!1),j(e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:"Thank you!"}),e.jsx("p",{children:'You will shortly recieve an email on the given adress with a link that will lead to the "Reset Password" form.'}),e.jsx("p",{children:"Make sure to check your spam folder if you haven't recived an email within 3 min."})]})),g(!0)},750))},v=()=>{const t=R(r.email),s=y(r.email,r.emailRetyped);w(t,s),t&&s&&E(r.email)};return e.jsxs(e.Fragment,{children:[f?e.jsx(F,{}):e.jsx(e.Fragment,{}),p?e.jsx(S,{message:x,onClose:d}):e.jsx(e.Fragment,{}),e.jsxs("section",{className:"firstView",children:[e.jsx(P,{}),e.jsxs("form",{children:[e.jsx("h5",{children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"emailInput",value:r.email,onChange:m}),e.jsx("h5",{children:"Retype Email"}),e.jsx("input",{type:"email",name:"emailRetyped",id:"retypeEmailInput",value:r.emailRetyped,onChange:m})]}),e.jsx("p",{className:"headlineSpacing",id:"errorMsg"}),e.jsxs("div",{className:"primaryBtnContainer",children:[e.jsx(c,{bgColor:"primary",onClick:v,children:e.jsx(e.Fragment,{children:"Reset Password"})}),e.jsx(c,{bgColor:"return",onClick:d,children:e.jsx(e.Fragment,{children:"Return"})})]})]})]})};export{U as ForgotPassword};
